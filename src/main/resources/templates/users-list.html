<!--/*@thymesVar id="user" type="ua.nure.kz.dto.UserDTO"*/-->
<!--/*@thymesVar id="error" type="java.lang.String"*/-->

<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{ layout :: head(~{::title}) }">
    <title>Users</title>
</head>

<body th:replace="~{ layout :: body(~{::#th-page-body})}">
<div id="th-page-body">
    <h3 th:if="${error != null}" th:text="${error}" style="color: red;">
        Error
    </h3>

    <th:block th:if="${user.isAdmin()}">
        <h3>Add user</h3>
        <form method="POST" th:action="@{/users}" class="d-flex col gap-2">
            <input name="login" placeholder="Login" class="form-control" />
            <input name="password" placeholder="Password" type="password" class="form-control" />
            <input name="fullName" placeholder="Full Name" class="form-control" />
            <select name="role" class="form-control">
                <option value="USER" selected>User</option>
                <option value="ADMIN">Administrator</option>
            </select>

            <button type="submit" class="btn btn-primary">Create</button>
        </form>
    </th:block>

    <h2>Users</h2>

    <table class="table mt-2">
        <thead>
        <tr>
            <th scope="col">Id</th>
            <th scope="col">Login</th>
            <th scope="col">Full Name</th>
            <th scope="col">Groups</th>
            <th th:if="${user.isAdmin()}" scope="col">Actions</th>
        </tr>
        </thead>

        <tbody>
        <th:block th:each="listUser : ${users}">
            <tr>
                <td scope="row" th:text="${listUser.id}">User ID</td>
                <td th:text="${listUser.login}">User Login</td>
                <td th:text="${listUser.fullName}">User Full Name</td>
                <td>
                    <th:block th:each="group, status : ${listUser.groups}">
                        <a th:href="@{/users(groupId=${group.id})}" th:text="${group.name}">
                            Group Name
                        </a>
                        <th:block th:if="${!status.last}">, </th:block>
                    </th:block>
                </td>
                <td th:if="${user.isAdmin()}">
                    <a class="btn btn-primary" th:href="@{${'/users/edit/'+listUser.id}}">Edit</a>
                    <a class="btn btn-danger" th:href="@{${'/users/delete/'+listUser.id}}">Delete</a>
                </td>
            </tr>
        </th:block>
        </tbody>
    </table>

    <nav th:replace="pagination :: pagination(${paginationInfo})"></nav>
</div>
</body>

</html>